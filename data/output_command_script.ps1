$RGName = 'cloudera-administrator'
$Location = 'West Europe'
$nsgName = 'centos7-elephant-nsg'
$NSG = Get-AzureRmNetworkSecurityGroup -Name $nsgName -ResourceGroupName $RGName
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'cloudera_custom_repositories' -Direction Inbound -Priority 302 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8900' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_address' -Direction Inbound -Priority 303 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50010' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_address_secure' -Direction Inbound -Priority 304 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '1004' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_http_address' -Direction Inbound -Priority 305 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50075' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_https_address' -Direction Inbound -Priority 306 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50475' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_http_address_secure' -Direction Inbound -Priority 307 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '1006' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_datanode_ipc_address' -Direction Inbound -Priority 308 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50020' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_fs_default_name' -Direction Inbound -Priority 309 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8020' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_namenode_servicerpc-address' -Direction Inbound -Priority 310 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8022' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_http_address' -Direction Inbound -Priority 311 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50070' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hdfs_dfs_https_address' -Direction Inbound -Priority 312 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50470' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'nfs_gateway_nfs' -Direction Inbound -Priority 313 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '2049' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'nfs_gateway_mountd' -Direction Inbound -Priority 314 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4242' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'nfs_gateway_portmapper' -Direction Inbound -Priority 315 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '111' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'nfs_gateway_nfs_http_port' -Direction Inbound -Priority 316 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50079' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'nfs_gateway_nfs_https_port' -Direction Inbound -Priority 317 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50579' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'httpfs_1' -Direction Inbound -Priority 318 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '14000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'httpfs_2' -Direction Inbound -Priority 319 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '14001' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'jobtracker_mapred_job_tracker' -Direction Inbound -Priority 320 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8021' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'jobtracker_mapred_ha_job_tracker' -Direction Inbound -Priority 321 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8023' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'jobtracker_mapred_job_tracker_http_address' -Direction Inbound -Priority 322 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50030' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'tasktracker_task_http_address' -Direction Inbound -Priority 323 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50060' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_resourcemanager_address' -Direction Inbound -Priority 324 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8032' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_resourcemanager_admin_address' -Direction Inbound -Priority 325 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8033' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_resourcemanager_webapp_address' -Direction Inbound -Priority 326 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8088' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_resourcemanager_webapp_https_address' -Direction Inbound -Priority 327 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8090' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_nodemanager_webapp_address' -Direction Inbound -Priority 328 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8042' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'yarn_nodemanager_webapp_https_address' -Direction Inbound -Priority 329 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8044' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'mapreduce_jobhistory_webapp_address' -Direction Inbound -Priority 330 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '19888' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'mapreduce_jobhistory_webapp_https_address' -Direction Inbound -Priority 331 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '19890' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'applicationmaster' -Direction Inbound -Priority 332 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '0' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'flume_agent' -Direction Inbound -Priority 333 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '41414' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'kms_http_port' -Direction Inbound -Priority 334 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '16000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_master_port' -Direction Inbound -Priority 335 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '60000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_master_info_port' -Direction Inbound -Priority 336 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '60010' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_regionserver_port' -Direction Inbound -Priority 337 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '60020' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_regionserver_info_port' -Direction Inbound -Priority 338 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '60030' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_rest_port' -Direction Inbound -Priority 339 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8080' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_rest_port_2' -Direction Inbound -Priority 340 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '20550' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'rest_ui' -Direction Inbound -Priority 341 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8085' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'thrift_server_cli' -Direction Inbound -Priority 342 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '9090' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'thrift_server' -Direction Inbound -Priority 343 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '9095' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'thrift_server_avro' -Direction Inbound -Priority 344 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '9090' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hbase_solr_indexer' -Direction Inbound -Priority 345 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '11060' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'metastore' -Direction Inbound -Priority 346 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '9083' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hive_server2_thrift_port' -Direction Inbound -Priority 347 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hive_server2_webui_port' -Direction Inbound -Priority 348 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10002' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'templeton_port' -Direction Inbound -Priority 349 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '50111' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'hue' -Direction Inbound -Priority 350 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8888' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'oozie_http_port' -Direction Inbound -Priority 351 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '11000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'oozie_https_port' -Direction Inbound -Priority 352 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '11443' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'sentry_service_server_rpc-port' -Direction Inbound -Priority 353 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '8038' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'sentry_service_web_port' -Direction Inbound -Priority 354 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '51000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'spark_default_master_rpc_port' -Direction Inbound -Priority 355 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '7077' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'spark_default_worker_rpc_port' -Direction Inbound -Priority 356 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '7078' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'spark_default_master_web_ui_port' -Direction Inbound -Priority 357 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '18080' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'spark_default_worker_web_ui_port' -Direction Inbound -Priority 358 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '18081' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'spark_history_server' -Direction Inbound -Priority 359 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '18088' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'sqoop_metastore_server_port' -Direction Inbound -Priority 360 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '16000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'sqoop_2_server' -Direction Inbound -Priority 361 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '12000' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'sqoop_2' -Direction Inbound -Priority 362 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '12001' -Protocol *
Add-AzureRmNetworkSecurityRuleConfig -NetworkSecurityGroup $NSG -Name 'clientport' -Direction Inbound -Priority 363 -Access Allow -SourceAddressPrefix 'INTERNET' -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '2181' -Protocol *
Set-AzureRmNetworkSecurityGroup -NetworkSecurityGroup $NSG